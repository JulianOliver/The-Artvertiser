<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>bazar: LightMap Class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="classes.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="classes.html"><span>Alphabetical&nbsp;List</span></a></li>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>LightMap Class Reference<br>
<small>
[<a class="el" href="group__photocalib.html">Photometric Calibration</a>]</small>
</h1><!-- doxytag: class="LightMap" -->Irradiance map computation, storage and augmentation.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="lightmap_8h-source.html">lightmap.h</a>&gt;</code>
<p>
<div class="dynheader">
Collaboration diagram for LightMap:</div>
<div class="dynsection">
<p><center><img src="classLightMap__coll__graph.png" border="0" usemap="#LightMap__coll__map" alt="Collaboration graph"></center>
<map name="LightMap__coll__map">
<area shape="rect" href="classIplTexture.html" title="IplTexture" alt="" coords="5,5,83,32"><area shape="rect" href="classCvGrowMat.html" title="CvGrowMat" alt="" coords="107,5,195,32"><area shape="rect" href="classLightCollector.html" title="LightCollector" alt="" coords="219,5,317,32"></map>
<center><font size="2">[<a href="graph_legend.html">legend</a>]</font></center></div>

<p>
<a href="classLightMap-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#69b9353805bad3e70929427baebfdc10">LightMap</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#72553b66041eb09ad1098cd3abe77cfa">~LightMap</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#2eb0d6196a6364058e255fd10092972a">LightMap</a> (const <a class="el" href="classLightMap.html">LightMap</a> &amp;a)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#27be21e2313fab5a58421ae7a8b5d27a">init</a> (int nbCam, IplImage *model, float corners[4][2], int nx, int ny)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#2e0dcc69d4ffa9db84c43fdcbd303a6d">setCamNum</a> (int n)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#f5a3eb707071d7385bf78978735f02db">initGL</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#c5f9a3fc95ed32dc26f5832f544f1d07">enableShader</a> (int cam, CvMat *obj2world)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#5823e7e6f489fd902338dce7460cafab">disableShader</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#d578c87e669531c25e45c82b79db652f">load</a> (const char *lightParamsFN=&quot;lightParams.mat&quot;, const char *normalsFN=&quot;normals.mat&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#618b12f1c71f00ea3ccf4d24afd8221e">save</a> (const char *lightParamsFN=&quot;lightParams.mat&quot;, const char *normalsFN=&quot;normals.mat&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#6b2f82b49c181c58dcd344aaabb56084">addNormal</a> (float normal[3], <a class="el" href="classLightCollector.html">LightCollector</a> &amp;lc, int cam)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">calls addNormalCalib if the system is not yet solved, or addNormallightMap otherwise.  <a href="#6b2f82b49c181c58dcd344aaabb56084"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#028884545fe490f5f391177372d7f090">addNormalCalib</a> (float normal[3], <a class="el" href="classLightCollector.html">LightCollector</a> &amp;lc, int cam)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a normal for future light map computation.  <a href="#028884545fe490f5f391177372d7f090"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#c0f562d25fc3e0a2ad71bff4d78cefd7">addNormalLightMap</a> (float normal[3], <a class="el" href="classLightCollector.html">LightCollector</a> &amp;lc, int cam)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the current light map with given <a class="el" href="classobservation.html">observation</a>.  <a href="#c0f562d25fc3e0a2ad71bff4d78cefd7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#efb6a3869d75593a07c221c2394e70c8">computeLightParams</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#d5caf56323b29078ea96b0fb43b473e7">isReady</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return true when <a class="el" href="classLightMap.html#efb6a3869d75593a07c221c2394e70c8">computeLightParams()</a> has succeeded.  <a href="#d5caf56323b29078ea96b0fb43b473e7"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#7f5abe34d49cadc8028c35d2676fbca1">saveImage</a> (const char *filename)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">const float *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#441a080cabe7c00b79c68ef2789c31d2">getGain</a> (int cam)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the (B,G,R) gain of a camera.  <a href="#441a080cabe7c00b79c68ef2789c31d2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const float *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#237d88772b64487863b1b56002339c2b">getBias</a> (int cam)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">return the (B,G,R) bias of a camera.  <a href="#237d88772b64487863b1b56002339c2b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">CvScalar&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#e4fbc9b952d487db2ccdd4a8ab96e8c1">readMap</a> (const float normal[3])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">returns the irradiance for a given normal.  <a href="#e4fbc9b952d487db2ccdd4a8ab96e8c1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#020d588e25bf8b5894c05185c277fdca">nbNormals</a> () const </td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the number of normals measured that'll be used by computeLightParams.  <a href="#020d588e25bf8b5894c05185c277fdca"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classIplTexture.html">IplTexture</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#22d9fa0b6ffc0e9fd6d2afe9e5725703">map</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Contains the irradiance map. Read it with readMap, update it with addNormal.  <a href="#22d9fa0b6ffc0e9fd6d2afe9e5725703"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="classLightCollector.html">LightCollector</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classLightMap.html#c1596d79a9d16fc197446bd75d281365">reflc</a></td></tr>

<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><b>Observation</b></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Irradiance map computation, storage and augmentation. 
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Julien Pilet</dd></dl>
This class computes a environmental radiance map and uses OpenGL to augment 3D objects accordingly.<p>
The process to build a light map is the following: After geometric calibration, it becomes possible to turn an <a class="el" href="classhomography.html" title="Static class for the estimation of homographies.Provides functions to estimate the...">homography</a> into a 3D pose (see <a class="el" href="classCamAugmentation.html" title="Turns homographies into 2D poses from calibrated views.">CamAugmentation</a>). Thus, when the planar target is detected on an image, it is possible to compute its normal in a reference coordinate system. It is also possible to compare its color with the model one. After collecting many views, a simple linear system computes gain and bias of each camera and the irradiance for each normal.<p>
All of this is done under lambertian assumption and might not behave very well in presence of specularities, specially in a multi-camera environment.<p>
Relighting 3D objects for augmentation can done by GPU using a vertex and a pixel shader. 
<p>Definition at line <a class="el" href="lightmap_8h-source.html#l00042">42</a> of file <a class="el" href="lightmap_8h-source.html">lightmap.h</a>.</p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="69b9353805bad3e70929427baebfdc10"></a><!-- doxytag: member="LightMap::LightMap" ref="69b9353805bad3e70929427baebfdc10" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LightMap::LightMap           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00016">16</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

</div>
</div><p>
<a class="anchor" name="72553b66041eb09ad1098cd3abe77cfa"></a><!-- doxytag: member="LightMap::~LightMap" ref="72553b66041eb09ad1098cd3abe77cfa" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LightMap::~LightMap           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00037">37</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, and <a class="el" href="lightmap_8h-source.html#l00076">map</a>.</p>

</div>
</div><p>
<a class="anchor" name="2eb0d6196a6364058e255fd10092972a"></a><!-- doxytag: member="LightMap::LightMap" ref="2eb0d6196a6364058e255fd10092972a" args="(const LightMap &amp;a)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">LightMap::LightMap           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classLightMap.html">LightMap</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>a</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00025">25</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8h-source.html#l00116">ARB</a>, <a class="el" href="lightcollector_8cpp-source.html#l00054">LightCollector::copy()</a>, <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="lightmap_8h-source.html#l00076">map</a>, <a class="el" href="lightmap_8h-source.html#l00078">reflc</a>, and <a class="el" href="ipltexture_8cpp-source.html#l00117">IplTexture::setImage()</a>.</p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="27be21e2313fab5a58421ae7a8b5d27a"></a><!-- doxytag: member="LightMap::init" ref="27be21e2313fab5a58421ae7a8b5d27a" args="(int nbCam, IplImage *model, float corners[4][2], int nx, int ny)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::init           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nbCam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">IplImage *&nbsp;</td>
          <td class="paramname"> <em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>corners</em>[4][2], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ny</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00045">45</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightcollector_8cpp-source.html#l00091">LightCollector::averageImage()</a>, <a class="el" href="lightcollector_8h-source.html#l00042">LightCollector::avg</a>, <a class="el" href="lightcollector_8cpp-source.html#l00126">LightCollector::genGrid()</a>, <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="lightmap_8h-source.html#l00076">map</a>, <a class="el" href="lightmap_8h-source.html#l00078">reflc</a>, <a class="el" href="lightmap_8cpp-source.html#l00416">setCamNum()</a>, and <a class="el" href="ipltexture_8cpp-source.html#l00117">IplTexture::setImage()</a>.</p>

<p>Referenced by <a class="el" href="artvertiser_2calibmodel_8cpp-source.html#l00041">CalibModel::buildCached()</a>.</p>

</div>
</div><p>
<a class="anchor" name="2e0dcc69d4ffa9db84c43fdcbd303a6d"></a><!-- doxytag: member="LightMap::setCamNum" ref="2e0dcc69d4ffa9db84c43fdcbd303a6d" args="(int n)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LightMap::setCamNum           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00416">416</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="growmat_8cpp-source.html#l00015">CvGrowMat::resize()</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00045">init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f5a3eb707071d7385bf78978735f02db"></a><!-- doxytag: member="LightMap::initGL" ref="f5a3eb707071d7385bf78978735f02db" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::initGL           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00259">259</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00337">enableShader()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c5f9a3fc95ed32dc26f5832f544f1d07"></a><!-- doxytag: member="LightMap::enableShader" ref="c5f9a3fc95ed32dc26f5832f544f1d07" args="(int cam, CvMat *obj2world)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LightMap::enableShader           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CvMat *&nbsp;</td>
          <td class="paramname"> <em>obj2world</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="multigl_8cpp-example.html#a79">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00337">337</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8cpp-source.html#l00259">initGL()</a>, <a class="el" href="ipltexture_8cpp-source.html#l00043">IplTexture::loadTexture()</a>, and <a class="el" href="lightmap_8h-source.html#l00076">map</a>.</p>

<p>Referenced by <a class="el" href="artvertiser_8cpp-source.html#l00618">photo_draw()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5823e7e6f489fd902338dce7460cafab"></a><!-- doxytag: member="LightMap::disableShader" ref="5823e7e6f489fd902338dce7460cafab" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void LightMap::disableShader           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="multigl_8cpp-example.html#a82">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00407">407</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="ipltexture_8cpp-source.html#l00103">IplTexture::disableTexture()</a>, and <a class="el" href="lightmap_8h-source.html#l00076">map</a>.</p>

<p>Referenced by <a class="el" href="artvertiser_8cpp-source.html#l00618">photo_draw()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d578c87e669531c25e45c82b79db652f"></a><!-- doxytag: member="LightMap::load" ref="d578c87e669531c25e45c82b79db652f" args="(const char *lightParamsFN=&quot;lightParams.mat&quot;, const char *normalsFN=&quot;normals.mat&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::load           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>lightParamsFN</em> = <code>&quot;lightParams.mat&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>normalsFN</em> = <code>&quot;normals.mat&quot;</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a22">fullcalib.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a93">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00677">677</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8cpp-source.html#l00522">loadMat()</a>, and <a class="el" href="growmat_8cpp-source.html#l00015">CvGrowMat::resize()</a>.</p>

<p>Referenced by <a class="el" href="draw_8cpp-source.html#l00928">photo_start()</a>, and <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00181">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="618b12f1c71f00ea3ccf4d24afd8221e"></a><!-- doxytag: member="LightMap::save" ref="618b12f1c71f00ea3ccf4d24afd8221e" args="(const char *lightParamsFN=&quot;lightParams.mat&quot;, const char *normalsFN=&quot;normals.mat&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::save           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>lightParamsFN</em> = <code>&quot;lightParams.mat&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>normalsFN</em> = <code>&quot;normals.mat&quot;</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a34">fullcalib.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a91">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00605">605</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8cpp-source.html#l00504">saveMat()</a>.</p>

<p>Referenced by <a class="el" href="draw_8cpp-source.html#l00869">photo_idle()</a>, and <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00181">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6b2f82b49c181c58dcd344aaabb56084"></a><!-- doxytag: member="LightMap::addNormal" ref="6b2f82b49c181c58dcd344aaabb56084" args="(float normal[3], LightCollector &amp;lc, int cam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::addNormal           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>normal</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLightCollector.html">LightCollector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
calls addNormalCalib if the system is not yet solved, or addNormallightMap otherwise. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a32">fullcalib.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a88">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00121">121</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8cpp-source.html#l00439">addNormalCalib()</a>, and <a class="el" href="lightmap_8cpp-source.html#l00143">addNormalLightMap()</a>.</p>

<p>Referenced by <a class="el" href="draw_8cpp-source.html#l00869">photo_idle()</a>, and <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00181">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="028884545fe490f5f391177372d7f090"></a><!-- doxytag: member="LightMap::addNormalCalib" ref="028884545fe490f5f391177372d7f090" args="(float normal[3], LightCollector &amp;lc, int cam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::addNormalCalib           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>normal</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLightCollector.html">LightCollector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Add a normal for future light map computation. 
<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00439">439</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightcollector_8h-source.html#l00042">LightCollector::avg</a>, <a class="el" href="lightcollector_8h-source.html#l00047">LightCollector::avgChannels</a>, <a class="el" href="lightcollector_8h-source.html#l00045">LightCollector::nbTri</a>, <a class="el" href="lightmap_8cpp-source.html#l00431">normalize()</a>, <a class="el" href="lightmap_8h-source.html#l00078">reflc</a>, and <a class="el" href="growmat_8cpp-source.html#l00015">CvGrowMat::resize()</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00121">addNormal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c0f562d25fc3e0a2ad71bff4d78cefd7"></a><!-- doxytag: member="LightMap::addNormalLightMap" ref="c0f562d25fc3e0a2ad71bff4d78cefd7" args="(float normal[3], LightCollector &amp;lc, int cam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::addNormalLightMap           </td>
          <td>(</td>
          <td class="paramtype">float&nbsp;</td>
          <td class="paramname"> <em>normal</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classLightCollector.html">LightCollector</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Update the current light map with given <a class="el" href="classobservation.html">observation</a>. 
<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00143">143</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightcollector_8cpp-source.html#l00269">LightCollector::cmpWithRef()</a>, <a class="el" href="lightmap_8cpp-source.html#l00136">getBias()</a>, <a class="el" href="lightmap_8cpp-source.html#l00129">getGain()</a>, <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="lightmap_8h-source.html#l00076">map</a>, and <a class="el" href="lightmap_8h-source.html#l00078">reflc</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00121">addNormal()</a>.</p>

</div>
</div><p>
<a class="anchor" name="efb6a3869d75593a07c221c2394e70c8"></a><!-- doxytag: member="LightMap::computeLightParams" ref="efb6a3869d75593a07c221c2394e70c8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::computeLightParams           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compute the light map using all available observations, previously added with addNormalCalib ir addNormal. <dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a33">fullcalib.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a90">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00611">611</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightcollector_8h-source.html#l00047">LightCollector::avgChannels</a>, <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="lightmap_8h-source.html#l00076">map</a>, and <a class="el" href="lightmap_8h-source.html#l00078">reflc</a>.</p>

<p>Referenced by <a class="el" href="draw_8cpp-source.html#l00869">photo_idle()</a>, and <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00181">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d5caf56323b29078ea96b0fb43b473e7"></a><!-- doxytag: member="LightMap::isReady" ref="d5caf56323b29078ea96b0fb43b473e7" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::isReady           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return true when <a class="el" href="classLightMap.html#efb6a3869d75593a07c221c2394e70c8">computeLightParams()</a> has succeeded. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a31">fullcalib.cpp</a>, <a class="el" href="multicam_8cpp-example.html#a42">multicam.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a78">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8h-source.html#l00073">73</a> of file <a class="el" href="lightmap_8h-source.html">lightmap.h</a>.</p>

<p>Referenced by <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00301">augment_scene()</a>, <a class="el" href="lightmap_8cpp-source.html#l00136">getBias()</a>, <a class="el" href="lightmap_8cpp-source.html#l00129">getGain()</a>, <a class="el" href="artvertiser_8cpp-source.html#l00618">photo_draw()</a>, <a class="el" href="draw_8cpp-source.html#l00869">photo_idle()</a>, <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00181">photometric_calibration()</a>, and <a class="el" href="lightmap_8cpp-source.html#l00104">readMap()</a>.</p>

</div>
</div><p>
<a class="anchor" name="7f5abe34d49cadc8028c35d2676fbca1"></a><!-- doxytag: member="LightMap::saveImage" ref="7f5abe34d49cadc8028c35d2676fbca1" args="(const char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool LightMap::saveImage           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>filename</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00712">712</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="artvertiser_8cpp-source.html#l00078">image</a>, and <a class="el" href="lightmap_8h-source.html#l00076">map</a>.</p>

</div>
</div><p>
<a class="anchor" name="441a080cabe7c00b79c68ef2789c31d2"></a><!-- doxytag: member="LightMap::getGain" ref="441a080cabe7c00b79c68ef2789c31d2" args="(int cam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const float * LightMap::getGain           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return the (B,G,R) gain of a camera. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a35">fullcalib.cpp</a>, <a class="el" href="multicam_8cpp-example.html#a46">multicam.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a74">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00129">129</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8h-source.html#l00073">isReady()</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00143">addNormalLightMap()</a>, <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00301">augment_scene()</a>, <a class="el" href="multigl_8cpp-source.html#l00351">photo_draw()</a>, and <a class="el" href="fullcalib-gl_8cpp-source.html#l00184">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="237d88772b64487863b1b56002339c2b"></a><!-- doxytag: member="LightMap::getBias" ref="237d88772b64487863b1b56002339c2b" args="(int cam)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const float * LightMap::getBias           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>cam</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
return the (B,G,R) bias of a camera. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a36">fullcalib.cpp</a>, <a class="el" href="multicam_8cpp-example.html#a47">multicam.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a75">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00136">136</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="lightmap_8h-source.html#l00073">isReady()</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00143">addNormalLightMap()</a>, <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00301">augment_scene()</a>, <a class="el" href="multigl_8cpp-source.html#l00351">photo_draw()</a>, and <a class="el" href="fullcalib-gl_8cpp-source.html#l00184">photometric_calibration()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e4fbc9b952d487db2ccdd4a8ab96e8c1"></a><!-- doxytag: member="LightMap::readMap" ref="e4fbc9b952d487db2ccdd4a8ab96e8c1" args="(const float normal[3])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CvScalar LightMap::readMap           </td>
          <td>(</td>
          <td class="paramtype">const float&nbsp;</td>
          <td class="paramname"> <em>normal</em>[3]          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
returns the irradiance for a given normal. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a52">fullcalib.cpp</a>, <a class="el" href="multicam_8cpp-example.html#a45">multicam.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a73">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8cpp-source.html#l00104">104</a> of file <a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a>.</p>

<p>References <a class="el" href="ipltexture_8h-source.html#l00060">IplTexture::getIm()</a>, <a class="el" href="lightmap_8h-source.html#l00073">isReady()</a>, and <a class="el" href="lightmap_8h-source.html#l00076">map</a>.</p>

<p>Referenced by <a class="el" href="artvertiser_2multicam_8cpp-source.html#l00301">augment_scene()</a>, and <a class="el" href="multigl_8cpp-source.html#l00351">photo_draw()</a>.</p>

</div>
</div><p>
<a class="anchor" name="020d588e25bf8b5894c05185c277fdca"></a><!-- doxytag: member="LightMap::nbNormals" ref="020d588e25bf8b5894c05185c277fdca" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int LightMap::nbNormals           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
the number of normals measured that'll be used by computeLightParams. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="multigl_8cpp-example.html#a89">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8h-source.html#l00091">91</a> of file <a class="el" href="lightmap_8h-source.html">lightmap.h</a>.</p>

<p>Referenced by <a class="el" href="draw_8cpp-source.html#l00869">photo_idle()</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="22d9fa0b6ffc0e9fd6d2afe9e5725703"></a><!-- doxytag: member="LightMap::map" ref="22d9fa0b6ffc0e9fd6d2afe9e5725703" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classIplTexture.html">IplTexture</a> <a class="el" href="classLightMap.html#22d9fa0b6ffc0e9fd6d2afe9e5725703">LightMap::map</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Contains the irradiance map. Read it with readMap, update it with addNormal. 
<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a25">fullcalib.cpp</a>, and <a class="el" href="multigl_8cpp-example.html#a83">multigl.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8h-source.html#l00076">76</a> of file <a class="el" href="lightmap_8h-source.html">lightmap.h</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00143">addNormalLightMap()</a>, <a class="el" href="lightmap_8cpp-source.html#l00611">computeLightParams()</a>, <a class="el" href="lightmap_8cpp-source.html#l00407">disableShader()</a>, <a class="el" href="lightmap_8cpp-source.html#l00337">enableShader()</a>, <a class="el" href="lightmap_8cpp-source.html#l00045">init()</a>, <a class="el" href="lightmap_8cpp-source.html#l00025">LightMap()</a>, <a class="el" href="multigl_8cpp-source.html#l00351">photo_draw()</a>, <a class="el" href="fullcalib-gl_8cpp-source.html#l00184">photometric_calibration()</a>, <a class="el" href="lightmap_8cpp-source.html#l00104">readMap()</a>, <a class="el" href="lightmap_8cpp-source.html#l00712">saveImage()</a>, and <a class="el" href="lightmap_8cpp-source.html#l00037">~LightMap()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c1596d79a9d16fc197446bd75d281365"></a><!-- doxytag: member="LightMap::reflc" ref="c1596d79a9d16fc197446bd75d281365" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classLightCollector.html">LightCollector</a> <a class="el" href="classLightMap.html#c1596d79a9d16fc197446bd75d281365">LightMap::reflc</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Examples: </b></dt><dd>
<a class="el" href="fullcalib_8cpp-example.html#a24">fullcalib.cpp</a>.</dl>
<p>Definition at line <a class="el" href="lightmap_8h-source.html#l00078">78</a> of file <a class="el" href="lightmap_8h-source.html">lightmap.h</a>.</p>

<p>Referenced by <a class="el" href="lightmap_8cpp-source.html#l00439">addNormalCalib()</a>, <a class="el" href="lightmap_8cpp-source.html#l00143">addNormalLightMap()</a>, <a class="el" href="artvertiser_2multigrab_8cpp-source.html#l00054">MultiGrab::allocLightCollector()</a>, <a class="el" href="lightmap_8cpp-source.html#l00611">computeLightParams()</a>, <a class="el" href="lightmap_8cpp-source.html#l00045">init()</a>, <a class="el" href="lightmap_8cpp-source.html#l00025">LightMap()</a>, and <a class="el" href="fullcalib-gl_8cpp-source.html#l00184">photometric_calibration()</a>.</p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>/home/julian/devel/artvertiser/garfeild/lightcalib/<a class="el" href="lightmap_8h-source.html">lightmap.h</a><li>/home/julian/devel/artvertiser/garfeild/lightcalib/<a class="el" href="lightmap_8cpp-source.html">lightmap.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Aug 17 16:17:33 2009 for bazar by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
